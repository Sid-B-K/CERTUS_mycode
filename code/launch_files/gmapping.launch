<launch>

  <!-- Arguments -->
  <arg name="scan_topic" default="/scan"/>
  <arg name="base_frame" default="base_link"/>
  <arg name="odom_frame" default="odom"/>

  <!-- GMapping Node -->
  <node pkg="gmapping" type="slam_gmapping" name="gmapping" output="screen">

    <!-- Frame parameters -->
    <param name="base_frame" value="$(arg base_frame)"/>
    <param name="odom_frame" value="$(arg odom_frame)"/>

    <!-- GMapping tuning parameters -->
    <param name="map_update_interval" value="1.0"/>
    <param name="linearUpdate" value="0.1"/>
    <param name="angularUpdate" value="0.1"/>
    <param name="minimumScore" value="50"/>
    <param name="particles" value="20"/>
    <param name="maxUrange" value="8.0"/>
    <param name="maxRange" value="10.0"/>
    <param name="xmin" value="-20.0"/>
    <param name="ymin" value="-20.0"/>
    <param name="xmax" value="20.0"/>
    <param name="ymax" value="20.0"/>
    <param name="delta" value="0.05"/>

    <!-- Topic remapping -->
    <remap from="scan" to="$(arg scan_topic)"/>
  </node>

  <!-- Static Transform: laser to base_link -->
  <node pkg="tf" type="static_transform_publisher" name="laser_to_base_link"
        args="0 0 0 0 0 0 base_link laser 100"/>

  <!-- EKF Localization Node -->
  <node pkg="robot_pose_ekf" type="robot_pose_ekf" name="ekf_localization" output="screen">

    <!-- EKF parameters -->
    <param name="output_frame" value="odom"/>
    <param name="base_footprint_frame" value="base_link"/>
    <param name="freq" value="30.0"/>
    <param name="sensor_timeout" value="1.0"/>

    <!-- Optional: Remap odometry topic -->
    <remap from="odom" to="/odom"/>
  </node>

</launch>
